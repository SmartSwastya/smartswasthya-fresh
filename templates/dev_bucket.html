<!-- templates/dev_bucket.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Dev Bucket</title>

  <!-- âœ… Tailwind CDN with safe override -->
  <script>
    // ðŸŸ¢ Step 1: Hide known CDN warnings BEFORE anything else
    console.warn = new Proxy(console.warn, {
      apply(target, thisArg, args) {
        if (args[0]?.includes?.('cdn.tailwindcss.com should not be used')) return;
        if (args[0]?.includes?.('@tailwindcss/line-clamp')) return;
        return target.apply(thisArg, args);
      }
    });
  </script>

  <!-- âœ… Tailwind CDN with plugins (minus redundant 'line-clamp') -->
  <script src="https://cdn.tailwindcss.com/3.4.1?plugins=forms,typography,aspect-ratio"></script>

  <!-- ðŸ›  Custom Tailwind config -->
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#d8e850',
            secondary: '#99e3f9',
          }
        }
      }
    };
  </script>

  <!-- ðŸŽ¨ Custom 135Â° Signature Gradient -->
  <style>
    .bg-gradient-135 {
      background-image: linear-gradient(135deg, #d8e850, #b8eecb, #99e3f9);
    }
  </style>
</head>
<body class="bg-gradient-to-br from-[#d8e850] to-[#99e3f9] min-h-screen p-8 font-sans">
  <div class="max-w-6xl mx-auto glassymorph bg-white/70 p-6 rounded-2xl shadow-lg backdrop-blur">

    <h1 class="text-3xl font-bold text-center mb-6">ðŸ§  Dev Bucket â€“ {{ tasks|length }} Tasks</h1>

    <!-- Filter Form -->
    <form method="get" class="flex flex-wrap gap-4 justify-center mb-6">
      <select name="status" class="p-2 rounded border">
        <option value="">Status</option>
        <option value="pending">Pending</option>
        <option value="in_progress">In Progress</option>
        <option value="complete">Complete</option>
      </select>
      <select name="priority" class="p-2 rounded border">
        <option value="">Priority</option>
        <option value="low">Low</option>
        <option value="medium">Medium</option>
        <option value="high">High</option>
      </select>
      <input type="submit" value="Filter" class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">
    </form>

    <!-- Tasks Table -->
    <div class="overflow-x-auto">
      <table class="min-w-full text-sm text-left border border-gray-300 rounded-lg">
        <thead class="bg-gray-100">
          <tr>
            <th class="p-3">ID</th>
            <th class="p-3">Title</th>
            <th class="p-3">Priority</th>
            <th class="p-3">Status</th>
            <th class="p-3">Tags</th>
            <th class="p-3">Updated</th>
            <th class="p-3 text-center">Actions</th>
          </tr>
        </thead>
        <tbody>
          {% for task in tasks %}
          <tr class="border-b hover:bg-gray-50">
            <td class="p-3">{{ task.id }}</td>
            <td class="p-3 font-medium">{{ task.title }}</td>
            <td class="p-3 capitalize">{{ task.priority or "â€”" }}</td>
            <td class="p-3 capitalize">{{ task.status }}</td>
            <td class="p-3">
              {% if task.tags %}
                {% for tag in task.tags %}
                  <span class="bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded mr-1">{{ tag }}</span>
                {% endfor %}
              {% else %}
                <span class="text-gray-400 italic">None</span>
              {% endif %}
            </td>
            <td class="p-3 text-xs text-gray-500">{{ task.updated_at.strftime('%Y-%m-%d') if task.updated_at else 'N/A' }}</td>
            <td class="p-3 text-center">
              <form method="post" action="/dev-bucket/status/{{ task.task_id }}">
                <input type="hidden" name="status" value="complete">
                <button class="text-green-600 hover:underline text-sm">âœ… Done</button>
              </form>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <p class="text-center text-xs text-gray-600 mt-4">Dev preview mode. Login gating coming soon.</p>
  </div>
</body>
</html>
